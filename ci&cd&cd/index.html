<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>CI/CD/CD - Map of zones Docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "CI/CD/CD";
    var mkdocs_page_input_path = "ci&cd&cd.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Map of zones Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Getting started</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../architecture/">Architecture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../front/">Front</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../graphql/">GraphQL</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../data/schema/">GraphQL public schema Types</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../data/schema2/">GraphQL admin schema Types</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../database/">Database</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../adaptor/">Stats adaptor</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../processor/">Tx processor</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../broker/">Message broker</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../watcher/">Watcher</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../proxy/">Proxy</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">CI/CD/CD</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#argocd-architecture">ArgoCD architecture</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#api-server">API Server</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#repository-server">Repository Server</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#application-controller">Application Controller</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#continuous-integration">Continuous Integration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#continuous-delivery">Continuous Delivery</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#continuous-deployment">Continuous Deployment</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Map of zones Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>CI/CD/CD</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="cicdcd">CI/CD/CD</h1>
<p><img alt="delivery-vs-deploy" src="../img/map-of-zones-delivery%20vs%20deploy.jpg" /></p>
<blockquote>
<p><em>To put it simply continuous integration is part of both continuous delivery and continuous deployment. And continuous deployment is like continuous delivery, except that releases happen automatically.</em></p>
</blockquote>
<h3 id="argocd-architecture">ArgoCD architecture</h3>
<p><img alt="delivery-vs-deploy" src="../img/argocd_architecture.png" /></p>
<h4 id="api-server">API Server</h4>
<p>The API server is a gRPC/REST server which exposes the API consumed by the Web UI, CLI, and CI/CD systems. It has the following responsibilities:</p>
<ul>
<li>application management and status reporting</li>
<li>invoking of application operations (e.g. sync, rollback, user-defined actions)</li>
<li>repository and cluster credential management (stored as K8s secrets)</li>
<li>authentication and auth delegation to external identity providers</li>
<li>RBAC enforcement</li>
<li>listener/forwarder for Git webhook events</li>
</ul>
<h4 id="repository-server">Repository Server</h4>
<p>The repository server is an internal service which maintains a local cache of the Git repository holding the application manifests. It is responsible for generating and returning the Kubernetes manifests when provided the following inputs:</p>
<ul>
<li>repository URL</li>
<li>revision (commit, tag, branch)</li>
<li>application path</li>
<li>template specific settings: parameters, ksonnet environments, helm values.yaml</li>
</ul>
<h4 id="application-controller">Application Controller</h4>
<p>The application controller is a Kubernetes controller which continuously monitors running applications and compares the current, live state against the desired target state (as specified in the repo). It detects OutOfSync application state and optionally takes corrective action. It is responsible for invoking any user-defined hooks for lifecycle events (PreSync, Sync, PostSync)</p>
<h2 id="continuous-integration">Continuous Integration</h2>
<blockquote>
<p><em>Developers merge their changes back to the main branch as often as possible. The developer's changes are validated by creating a build and running automated tests against the build. By doing so, you avoid integration challenges that can happen when waiting for release day to merge changes into the release branch.</em><br>
<em>Continuous integration puts a great emphasis on testing automation to check that the application is not broken whenever new commits are integrated into the main branch.</em></p>
</blockquote>
<p><strong>Continuous integration has several main stages:</strong></p>
<ul>
<li>When changes are pushed to the master branch of the repositories at <a href="https://github.com/mapofzones">github.com/mapofzones</a>, <strong>GitHub Actions</strong> are triggered.</li>
<li><strong>GitHub Actions</strong> builds, tests, creates docker images and publishes them in our container registry on DigitalOcean - <code>registry.digitalocean.com/mapofzones</code>.</li>
<li>After completing the job, <strong>GitHub Actions</strong> sends a notification to the telegram chat about the success or failure of the execution.</li>
</ul>
<p><strong>GitHub Actions</strong> workflow settings are described in each repository in the <code>.github/workflows</code> directory.</p>
<p>Each GitHub repository has secret keys for publishing images, for sending messages to telegrams, etc.</p>
<h2 id="continuous-delivery">Continuous Delivery</h2>
<blockquote>
<p><em>Continuous delivery is an extension of continuous integration since it automatically deploys all code changes to a testing and/or production environment after the build stage.</em><br>
<em>This means that on top of automated testing, you have an automated release process and you can deploy your application any time by clicking a button or automatically.</em></p>
</blockquote>
<p>Our continuous delivery uses <a href="./#argocd-architecture">argoCD</a> and keeps track of the <strong>"dev"</strong> directory in the <strong>"deploy"</strong> repository. The development application configuration for <a href="./#argocd-architecture">argoCD</a> is located at <strong>deploy/dev/app.yaml</strong>. Any changes made to the <strong>dev</strong> directory of the deploy repository will be reflected on the development server.</p>
<h2 id="continuous-deployment">Continuous Deployment</h2>
<blockquote>
<p><em>Continuous deployment goes one step further than continuous delivery. With this practice, every change that passes all stages of your production pipeline is released to your product.</em></p>
</blockquote>
<p>Our continuous deployment uses <a href="./#argocd-architecture">argoCD</a> and keeps track of the <strong>"prod"</strong> directory in the <strong>"deploy"</strong> repository. The production application configuration for <a href="./#argocd-architecture">argoCD</a> is located at <strong>deploy/prod/app.yaml</strong>. Any changes made to the <strong>prod</strong> directory of the deploy repository will be reflected on the production server, but unlike development server for added security, automatic initialization of synchronization is disabled on the production server. This means that to start a new synchronization, you need to click on the <strong>"SYNC"</strong> button in the <a href="./#argocd-architecture">argoCD</a> client, or do it through the console.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../changelog/" class="btn btn-neutral float-right" title="Changelog">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../proxy/" class="btn btn-neutral" title="Proxy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../proxy/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../changelog/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
